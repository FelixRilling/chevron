"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?"Chevron":arguments[0];_classCallCheck(this,a);var c=this;c.options={name:b},c.container={},c.injects={middleware:[],decorator:[]},c.cv={prepare:function(a){var b=void 0,d={};return c.cv.fetchDependencies(a.dependencies,function(a,b){var e=void 0;e=a.constructed?a:c.cv.construct(a,d),c.cv.runMiddleware(e,d),d[b]=e.content},function(a){c.throwMissingDep(a)}),b=a.constructed?a:c.cv.construct(a,d),c.cv.runMiddleware(b,d),b},fetchDependencies:function(a,b,d){c.cv.ut.each(a,function(a){if(c.cv.exists(a)){var e=c.cv.get(a);c.cv.hasDependencies(e)&&c.cv.fetchDependencies(e.dependencies,b,d),b(e,a)}else d(a)})},add:function(a,b,d,e,f){var g=c.container[a]={dependencies:b||[],type:d,content:e,constructed:!1,name:a};"factory"===d&&(g.args=f||[],g.args.shift())},construct:function(a,b){return a=c.cv.runDecorator(a,b),c.cv.hasType(a,"service")?a.content=a.content.bind(b):c.cv.hasType(a,"factory")&&!function(){var d=Object.create(a.prototype||Object.prototype);c.cv.ut.eachObject(b,function(a,b){d[b]=a}),a.content=a.content.apply(d,a.args)||d}(),a.constructed=!0,a},runMiddleware:function(a,b){c.cv.runInject("middleware",a,function(c){c.fn.call(b,a)})},runDecorator:function(a,b){var d=!1;return c.cv.runInject("decorator",a,function(c){d=c.fn.call(b,a,d)}),d===!1?a:d},runInject:function(a,b,d){c.cv.ut.each(c.injects[a],function(a){c.cv.injectorApplies(b.name,a)&&d(a)})},injectorApplies:function(a,b){return 0===b.applies.length?!0:b.applies.includes(a)},exists:function(a){return c.cv.ut.isDefined(c.container[a])},get:function(a){return c.container[a]},hasType:function(a,b){return a.type===b},hasDependencies:function(a){return a.dependencies.length>0},throwMissingDep:function(a,b,d){c.cv.ut.log(a,"error",b,"dependency '"+d+"' not found")},throwNotFound:function(a){c.cv.ut.log(a,"error","type","service '"+a+"' not found")},throwDupe:function(a,b){c.cv.ut.log(a,"error",b,"service '"+a+"' is already defined")},ut:{each:function(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)},eachObject:function(a,b){for(var c=Object.keys(a),d=0,e=c.length;e>d;d++)b(a[c[d]],c[d],d)},isDefined:function(a){return"undefined"!=typeof a},log:function(a,b,d,e){var f=c.options.name+" "+b+" in "+d+" '"+a+"': "+e;if("error"===b)throw f}}}}return _createClass(a,[{key:"provider",value:function(a,b,c,d,e){var f=this;return f.cv.exists(a)?f.cv.throwDupe(a,d):f.cv.add(a,b,d,c,e),f}},{key:"service",value:function(a,b,c){return this.provider(a,b,c,"service")}},{key:"factory",value:function(a,b,c,d){return d.unshift(null),this.provider(a,b,c,"factory",d)}},{key:"injector",value:function(a,b,c){var d=this;return d.injects[a].push({fn:b,applies:c||[]}),d}},{key:"decorator",value:function(a,b){return this.injector("decorator",a,b)}},{key:"middleware",value:function(a,b){return this.injector("middleware",a,b)}},{key:"access",value:function(a){var b=this;return b.cv.exists(a)?b.cv.prepare(b.cv.get(a)).content:void b.cv.throwNotFound(a)}},{key:"list",value:function(){return this.container}}]),a}();a.Chevron=b}(window);