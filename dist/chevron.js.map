{"version":3,"file":"chevron.js","sources":["../node_modules/lightdash/dist/esm/src/object/name.js","esm/src/bootstrap/DefaultBootstrappings.js","esm/src/scope/DefaultScopes.js","esm/src/Chevron.js","esm/src/decorators/Injectable.js","esm/src/decorators/Autowired.js"],"sourcesContent":["import { isObject, isString, isSymbol } from \"lodash\";\n/**\n * Gets name of a value.\n *\n * If the value has a name or description property, the value of that is returned.\n * If the value is a string, it is returned as is.\n * Otherwise null is returned.\n *\n * @since 10.2.0\n * @memberOf Object\n * @param value Value to check.\n * @returns The name of the value.\n * @example\n * name(class Foo{})\n * // => \"Foo\"\n *\n * name(function bar(){})\n * // => \"bar\"\n *\n * name(Symbol(\"abc\"))\n * // => \"abc\"\n *\n * name(\"foo\")\n * // => \"foo\"\n *\n * name(1)\n * // => null\n */\nconst name = (value) => {\n    if (isString(value)) {\n        return value;\n    }\n    // eslint-disable-next-line no-extra-parens\n    if (isObject(value) && isString(value.name)) {\n        // eslint-disable-next-line no-extra-parens\n        return value.name;\n    }\n    if (isSymbol(value) && isString(value.description)) {\n        return value.description;\n    }\n    return null;\n};\nexport { name };\n//# sourceMappingURL=name.js.map","import { isFunction } from \"lodash\";\nconst createNonFunctionInitializerError = () => new TypeError(\"Non-functions cannot be bootstrapped by this bootstrapper.\");\nconst classBootstrapping = (initializer, dependencies) => {\n    if (!isFunction(initializer)) {\n        throw createNonFunctionInitializerError();\n    }\n    return Reflect.construct(initializer, dependencies);\n};\nconst functionBootstrapping = (initializer, dependencies) => (...args) => {\n    if (!isFunction(initializer)) {\n        throw createNonFunctionInitializerError();\n    }\n    return initializer(...dependencies, ...args);\n};\nconst identityBootstrapping = (initializer) => initializer;\nconst DefaultBootstrappings = {\n    CLASS: classBootstrapping,\n    FUNCTION: functionBootstrapping,\n    IDENTITY: identityBootstrapping\n};\nexport { DefaultBootstrappings };\n//# sourceMappingURL=DefaultBootstrappings.js.map","const singletonScope = (context, injectableEntryName) => `SINGLETON_${injectableEntryName}`;\nconst prototypeScope = () => null;\nconst DefaultScopes = {\n    SINGLETON: singletonScope,\n    PROTOTYPE: prototypeScope\n};\nexport { DefaultScopes };\n//# sourceMappingURL=DefaultScopes.js.map","import { defaults, isNil, isString } from \"lodash\";\nimport { name as getName } from \"lightdash\";\nimport { DefaultBootstrappings } from \"./bootstrap/DefaultBootstrappings\";\nimport { DefaultScopes } from \"./scope/DefaultScopes\";\nconst guessName = (initializer) => {\n    const guessedName = getName(initializer);\n    if (isNil(guessedName)) {\n        throw new TypeError(`Could not guess name of ${initializer}, please explicitly define one.`);\n    }\n    return guessedName;\n};\nconst getInjectableName = (name) => isString(name) ? name : guessName(name);\nconst createCircularDependencyError = (entryName, resolveStack) => {\n    return new Error(`Circular dependencies found: '${[...resolveStack, entryName].join(\"->\")}'.`);\n};\n/**\n * Injectable container class.\n *\n * @class\n */\nclass Chevron {\n    constructor() {\n        this.injectables = new Map();\n    }\n    registerInjectable(initializer, dependencies, options = {}) {\n        const { bootstrapping, scope, name } = defaults(options, {\n            bootstrapping: DefaultBootstrappings.IDENTITY,\n            scope: DefaultScopes.SINGLETON,\n            name: null\n        });\n        const injectableEntryName = !isNil(name)\n            ? name\n            : guessName(initializer);\n        if (this.injectables.has(injectableEntryName)) {\n            throw new Error(`Name already exists: '${injectableEntryName}'.`);\n        }\n        this.injectables.set(injectableEntryName, {\n            initializer,\n            bootstrapping,\n            scope,\n            dependencies: dependencies.map(getInjectableName),\n            instances: new Map()\n        });\n    }\n    hasInjectable(name) {\n        return this.injectables.has(getInjectableName(name));\n    }\n    hasInjectableInstance(name, context = null) {\n        const { injectableEntry, instanceName } = this.resolveInjectableInstance(name, context);\n        return (instanceName != null && injectableEntry.instances.has(instanceName));\n    }\n    getInjectableInstance(name, context = null) {\n        return this.getBootstrappedInjectableInstance(name, context, new Set());\n    }\n    resolveInjectableInstance(name, context) {\n        const injectableEntryName = getInjectableName(name);\n        if (!this.injectables.has(injectableEntryName)) {\n            throw new Error(`Injectable '${name}' does not exist.`);\n        }\n        const injectableEntry = this.injectables.get(injectableEntryName);\n        const instanceName = injectableEntry.scope(context, injectableEntryName, injectableEntry);\n        return {\n            injectableEntryName: injectableEntryName,\n            injectableEntry,\n            instanceName\n        };\n    }\n    getBootstrappedInjectableInstance(name, context, resolveStack) {\n        const { injectableEntryName, injectableEntry, instanceName } = this.resolveInjectableInstance(name, context);\n        if (instanceName != null &&\n            injectableEntry.instances.has(instanceName)) {\n            return injectableEntry.instances.get(instanceName);\n        }\n        /*\n         * Start bootstrapping value.\n         */\n        if (resolveStack.has(injectableEntryName)) {\n            throw createCircularDependencyError(injectableEntryName, resolveStack);\n        }\n        resolveStack.add(injectableEntryName);\n        const bootstrappedDependencies = injectableEntry.dependencies.map(dependencyName => this.getBootstrappedInjectableInstance(dependencyName, context, resolveStack));\n        const instance = injectableEntry.bootstrapping(injectableEntry.initializer, bootstrappedDependencies, injectableEntryName, injectableEntry);\n        if (instanceName != null) {\n            injectableEntry.instances.set(instanceName, instance);\n        }\n        resolveStack.delete(injectableEntryName);\n        return instance;\n    }\n}\nexport { Chevron };\n//# sourceMappingURL=Chevron.js.map","const Injectable = (instance, dependencies, options = {}) => (target) => {\n    instance.registerInjectable(target, dependencies, options);\n    return target;\n};\nexport { Injectable };\n//# sourceMappingURL=Injectable.js.map","const Autowired = (instance, name, context = null) => (target, propertyKey) => {\n    target[propertyKey] = instance.getInjectableInstance(name, context);\n};\nexport { Autowired };\n//# sourceMappingURL=Autowired.js.map"],"names":["isString","isObject","isSymbol","isFunction","getName","isNil","defaults"],"mappings":"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"}